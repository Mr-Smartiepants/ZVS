{% extends "base_admin.html" %}

{% block page_title %}Benutzer hinzufügen - Admin Panel{% endblock %}
{% block page_header %}Benutzer hinzufügen{% endblock %}

{% block extra_scripts %}
<script>
  function togglePasswordField() {
    const isAdminCheckbox = document.getElementById('is_admin');
    const passwordField = document.getElementById('password_field');
    if (isAdminCheckbox.checked) {
      passwordField.style.display = 'block';
    } else {
      passwordField.style.display = 'none';
    }
  }
</script>
{% endblock %}

{% block content %}
<div class="max-w-md mx-auto bg-white rounded-xl shadow p-6">
    <form method="POST" action="{{ url_for('auth.add_user') }}" class="space-y-4">
        <div>
            <label for="display_name" class="block text-gray-700 font-bold mb-2">
                Anzeigename
            </label>
            <input
                type="text"
                id="display_name"
                name="display_name"
                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"
                placeholder="z.B. RoteRakete42"
            />
        </div>

        <div>
            <label for="real_name" class="block text-gray-700 font-bold mb-2">
                Echter Name (wird nur in der CSV gespeichert)
            </label>
            <input
                type="text"
                id="real_name"
                name="real_name"
                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"
                placeholder="Vorname Nachname"
            />
            <p class="text-xs text-gray-500 mt-1">Der reale Name wird DSGVO-konform nur in der Mapping-Datei gespeichert.</p>
        </div>

        <div>
            <label for="is_admin" class="inline-flex items-center cursor-pointer">
                <input
                    type="checkbox"
                    id="is_admin"
                    name="is_admin"
                    class="w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"
                    onclick="togglePasswordField()"
                />
                <span class="ml-2 text-gray-700 font-bold">Als Admin hinzufügen</span>
            </label>
        </div>

        <div id="password_field" class="hidden">
            <label for="password" class="block text-gray-700 font-bold mb-2">
                Passwort
            </label>
            <input
                type="password"
                id="password"
                name="password"
                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500"
                placeholder="Passwort für Admin"
            />
            <p class="text-xs text-gray-500 mt-1">Erforderlich, wenn Admin-Checkbox aktiviert ist</p>
        </div>

        <div class="flex gap-2 pt-4">
            <button
                type="submit"
                class="flex-1 bg-green-500 text-white font-bold px-4 py-2 rounded hover:bg-green-600 transition"
            >
                Hinzufügen
            </button>
            <a
                href="{{ url_for('auth.list_users') }}"
                class="flex-1 bg-gray-500 text-white font-bold px-4 py-2 rounded hover:bg-gray-600 transition text-center"
            >
                Abbrechen
            </a>
        </div>
    </form>
</div>
{% endblock %}
