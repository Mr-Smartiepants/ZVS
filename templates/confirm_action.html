<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>Aktion bestätigen</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="bg-white p-8 rounded-xl shadow-md w-full max-w-md">
      <h1 class="text-2xl font-bold text-center text-blue-600 mb-6">
        Aktion bestätigen
      </h1>
      {% if zeitschrift and user %}
      <div class="mb-6 text-center">
        <p class="text-gray-700 mb-2">
          <strong>{{ display_name or user.username }}</strong><br />
          Zeitschrift: <strong>{{ zeitschrift.Titel }}</strong><br />
          Ausgabe: <strong>{{ zeitschrift.AusgabeHeftnummer or '-' }}</strong><br />
          Barcode: <strong>{{ zeitschrift.barcode or '-' }}</strong><br />
          Verfügbar: <strong>{{ verfuegbar }}</strong>
        </p>
        {% if verfuegbar > 0 %}
          <p class="text-green-700 font-semibold mb-4">
            Es sind Exemplare verfügbar. Ausleihen oder Rückgabe erfassen?
          </p>
          <div class="space-y-2">
            <form method="POST">
              <input type="hidden" name="exemplar_id" value="{{ zeitschrift.ExemplarID }}" />
              <input type="hidden" name="user_id" value="{{ user.id }}" />
              <input type="hidden" name="action" value="ausleihe" />
              <button
                type="submit"
                class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition"
              >
                Ausleihen
              </button>
            </form>
            <form method="POST">
              <input type="hidden" name="exemplar_id" value="{{ zeitschrift.ExemplarID }}" />
              <input type="hidden" name="user_id" value="{{ user.id }}" />
              <input type="hidden" name="action" value="rueckgabe" />
              <button
                type="submit"
                class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 transition"
              >
                Rückgabe erfassen
              </button>
            </form>
          </div>
        {% else %}
          <p class="text-red-700 font-semibold mb-4">
            Keine Exemplare verfügbar. Nur Rückgabe möglich.
          </p>
          <form method="POST">
            <input type="hidden" name="exemplar_id" value="{{ zeitschrift.ExemplarID }}" />
            <input type="hidden" name="user_id" value="{{ user.id }}" />
            <input type="hidden" name="action" value="rueckgabe" />
            <button
              type="submit"
              class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 transition"
            >
              Rückgabe erfassen
            </button>
          </form>
        {% endif %}
      </div>
      {% else %}
      <p class="text-red-700 text-center">
        Fehler: Zeitschrift oder Benutzer nicht gefunden.
      </p>
      {% endif %}
      <div class="mt-4 flex justify-between">
        <a
          href="{{ url_for('zeitschriften.scan_page', user_id=user.id if user else '') }}"
          class="bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500 transition"
          >Zurück zum Scanner</a
        >
        <a
          href="{{ url_for('index') }}"
          class="bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300 transition"
          >Benutzer wechseln</a
        >
      </div>
    </div>
  </body>
</html>
